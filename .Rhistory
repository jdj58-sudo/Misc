plot(income,gamble,pch=as.numeric(sex),col=as.character(sex))
plot(income,gamble,pch=as.character(sex),col=as.numeric(sex)+4)
#Q6
boxplot(gamble~sex,names=c("male","female"),main=c("Gambling amount"))
var.test(gamble[sex==0],gamble[sex==1])
#Q7
par(mfrow=c(2,2))
plot(model1)
#Q8
sex <- factor(sex)
is.factor(sex)
model3 <- lm(gamble~income*sex)
summary(model3)
#Q10
par(mfrow=c(2,2))
plot(income,gamble,pch=as.character(sex))
abline(-2.6596+5.7996, 6.5181-6.3432,lwd=2,col=2)
abline(-2.6596, 6.5181,lwd=2,col=4)
#Q10
plot(income,gamble,pch=as.character(sex))
abline(6.5181-6.3432,-2.6596+5.7996,lwd=2,col=2)
abline(6.5181,-2.6596,lwd=2,col=4)
plot(income,gamble,pch=as.character(sex))
abline(-6.3432,5.7996,lwd=2,col=2)
abline(6.5181,-2.6596,lwd=2,col=4)
plot(income,gamble,pch=as.character(sex))
abline(-6.3432,5.7996,lwd=2,col=2)
abline(-6.3432,-2.6596,lwd=2,col=4)
#ANS
par(mfrow=c(2,2))
plot(income,gamble,pch=as.character(sex))
abline(-2.6596+5.7996, 6.5181-6.3432,lwd=2,col=2)
abline(-2.6596, 6.5181,lwd=2,col=4)
install.packages("PASWR2")
install.packages("car")
library(PASWR2)
library(car)
cardim(HSWRESTLER)
dim(HSWRESTLER)
attach(HSWRESTLER)
head(HSWRESTLER)
dataEllipse(wt, hwfat)
dataEllipse(wt, hwfat, xlim=c(20,300), ylim=c(0,45))
dataEllipse(wt, hwfat, xlim=c(20,300), ylim=c(-45,45))
dataEllipse(wt, hwfat, xlim=c(20,300), ylim=c(0,45) pch=16, col=c("re$"))
dataEllipse(wt, hwfat, xlim=c(20,300), ylim=c(0,45) pch=16, col=c("red$blue"))
dataEllipse(wt, hwfat, xlim=c(20,300), ylim=c(0,45) pch=16, col=c("red"))
dataEllipse(wt, hwfat, xlim=c(20,300), ylim=c(0,45) pch=16, col=c("red", "blue"))
dataEllipse(wt, hwfat, xlim=c(20,300), ylim=c(0,45) pch=16)
dataEllipse(wt, hwfat, xlim=c(20,300), ylim=c(0,45))
dataEllipse(wt, hwfat, xlim=c(20,300), ylim=c(-45,45))
cor(wt, hwfat)
#2
model1 <- lm(hwfat~age+ht+wt+abs+triceps+subscap)
summary(model1)
points(0,0,pch=16,col="purple",cex=3)
#3
confidenceEllipse(model1, c("wt", "ht"))
points(0,0,pch=16,col="purple",cex=3)
#4
model1 <- lm(hwfat~gae+ht+wt+abs+tricepts+subcaps)
model2 <- lm(hwfat~gae+ abs+tricepts+subcaps)
#4
model1 <- lm(hwfat~age+ht+wt+abs+tricepts+subcaps)
model2 <- lm(hwfat~age+ abs+tricepts+subcaps)
#4
model1 <- lm(hwfat~age+ht+wt+abs+triceps+subcaps)
model2 <- lm(hwfat~age+ abs+triceps+subcaps)
#4
model1 <- lm(hwfat~age+ht+wt+abs+triceps+subscaps)
model2 <- lm(hwfat~age+ abs+triceps+subscaps)
#4
model1 <- lm(hwfat~age+ht+wt+abs+triceps+subscap)
model2 <- lm(hwfat~age+ abs+triceps+subscap)
anova(model2, model1)
anova(model1)
anova(model2)
1-pf(0.6634, 2, 71)
#6
influencePlot(model1)
#6
influencePlot(model1)
View(model2)
0.07223752-0.15038925
influenceIndexPlot(model1)
#7
install.packages("PASWR2")
install.packages("car")
library(PASWR2)
library(car)
dim(HSWRESTLER)
attach(HSWRESTLER)
head(HSWRESTLER)
#1
dataEllipse(wt, hwfat)
dataEllipse(wt, hwfat, xlim=c(20,300), ylim=c(0,45))
dataEllipse(wt, hwfat, xlim=c(20,300), ylim=c(-45,45))
cor(wt, hwfat)
#2
model1 <- lm(hwfat~age+ht+wt+abs+triceps+subscap)
summary(model1)
#3
confidenceEllipse(model1, c("wt", "ht"))
points(0,0,pch=16,col="purple",cex=3)
#4
model1 <- lm(hwfat~age+ht+wt+abs+triceps+subscap)
model2 <- lm(hwfat~age+ abs+triceps+subscap)
anova(model2, model1)
anova(model1)
anova(model2)
1-pf(0.6634, 2, 71)
#8
data2 <- round(cbind(rstudent(model1),cooks.distance(model1),influence(model1)$hat), 3)
colnames(data2) <- c("studentRes","CooksDist","Hat")
data2[c(5,27,35,42),]
install.packages("faraway")
library(faraway)
data(divusa)
attach(divusa)
divusa[1:3,]
dim(divusa)
model1 <- lm(divorce~unemployed+femlab+marriage+birth+military)
library(car)
durbinWatsonTest(model1)
#3
plot(model1$resid, pch=16, col="red", type="o")
abline(h=0, lty=2, col="blue")
# Plot successive residuals
plot(x, y,
main = "Successive Residuals Plot",
xlab = expression(e[t]),
ylab = expression(e[t+1]),
pch = 16,
col = "darkred")
# Add a reference line to highlight the correlation
abline(lm(y ~ x), col = "blue", lwd = 2, lty = 2)
#4
# Extract residuals from model1
res <- residuals(model1)
# Create vectors for e_t and e_{t+1}
x <- res[-length(res)]     # e_t (all but the last residual)
y <- res[-1]               # e_{t+1} (all but the first residual)
# Plot successive residuals
plot(x, y,
main = "Successive Residuals Plot",
xlab = expression(e[t]),
ylab = expression(e[t+1]),
pch = 16,
col = "darkred")
# Add a reference line to highlight the correlation
abline(lm(y ~ x), col = "blue", lwd = 2, lty = 2)
#4 basic
res <- residuals(model1)
plot(res[-length(res)], res[-1],
xlab = "Residual[i]",
ylab = "Residual[i+1]",
main = "Successive Residuals Plot",
pch = 16)
#4 basic
res <- residuals(model1)
plot(res[-length(res)], res[-1], pch = 16)
#plot(res[-length(res)], res[-1],
#plot(res[-length(res)], res[-1],
#     xlab = "Residual[i]",
#plot(res[-length(res)], res[-1],
#     xlab = "Residual[i]",
#     ylab = "Residual[i+1]",
#plot(res[-length(res)], res[-1],
#     xlab = "Residual[i]",
#     ylab = "Residual[i+1]",
#     main = "Successive Residuals Plot",
data1 <- read.csv(file.choose())
dim(data1)
head(data1)
attach(data1)
SITE <- factor(SITE)
is.factor(SITE)
model1 <- lm(BVOL~JAWL+SITE)
summary(model1)
#1
par(mfrow=c(2,2))
plot(model1)
#1
par(mfrow=c(2,2), mar=c(5,5,4,2))  # Adjust margins to give more space
plot(model1)
#1
png("model_diagnostics.png", width=1000, height=800, res=150)  # Increase resolution
par(mfrow=c(2,2))
plot(model1)
dev.off()
#1
png("model_diagnostics.png", width=1000, height=800, res=150)  # Increase resolution
par(mfrow=c(2,2))
plot(model1)
dev.off()
#1
par(mfrow=c(2,2))
plot(model1, asp=1)  # Adjust aspect ratio for better balance
#2
library(MASS)
boxcox(model1)
boxcox(model1, seq(-0.3,0.3,0.01))
#boxcox(model1)
boxcox(model1, seq(-0.3,0.3,0.01))
#boxcox(model1)
boxcox(model1, seq(-0.3,0.3,0.01))
#
model2 <- lm(log(BVOL)~JAWL+SITE)
boxcox(model2)
#2
library(MASS)
#boxcox(model1)
boxcox(model1, seq(-0.3,0.3,0.01))
#
model2 <- lm(log(BVOL)~JAWL+SITE)
boxcox(model2)
#2
library(MASS)
#boxcox(model1)
boxcox(model1, seq(-0.3,0.3,0.01))
#
model2 <- lm(log(BVOL)~JAWL+SITE)
par(mfrow=c(2,2))
plot(model2, asp=1)
#
model2 <- lm(log(BVOL)~JAWL+SITE)
par(mfrow=c(2,2))
plot(model2, asp=1)
plot(model2, asp=1)
plot(model2, asp=2)
plot(model2)
#6
summary(model2)
#8
library(car)
durbinWatsonTest(model2)
durbinWatsonTest(model1)
#9
library(faraway)
data(divusa)
dim(divusa)
head(divusa)
attach(divusa)
model4 <- lm(divorce~unemployed+femlab+marriage+birth+military)
model5 <- lm(divorce~unemployed+       marriage+      military)
anova(model5, model4)
#10
library(faraway)
vif(model4)
#1
par(mfrow=c(2,2))
plot(model1, asp=1)  # Adjust aspect ratio for better balance
#2
library(MASS)
#boxcox(model1)
boxcox(model1, seq(-0.3,0.3,0.01))
#
model2 <- lm(log(BVOL)~JAWL+SITE)
par(mfrow=c(2,2))
plot(model2)
#2
library(MASS)
#boxcox(model1)
boxcox(model1, seq(-0.3,0.3,0.01))
boxcox(model1, seq(-0.3,0.3,0.01))
install.packages("faraway")
library(faraway)
data(divusa)
attach(divusa)
divusa[1:3,]
dim(divusa)
#1,2
model1 <- lm(divorce~unemployed+femlab+marriage+birth+military)
library(car)
durbinWatsonTest(model1)
#3
plot(model1$resid, pch=16, col="red", type="o")
abline(h=0, lty=2, col="blue")
#4
# Extract residuals from model1
res <- residuals(model1)
# Create vectors for e_t and e_{t+1}
x <- res[-length(res)]     # e_t (all but the last residual)
y <- res[-1]               # e_{t+1} (all but the first residual)
# Plot successive residuals
plot(x, y,
#    main = "Successive Residuals Plot",
xlab = expression(e[t]),
ylab = expression(e[t+1]),
pch = 16,
col = "darkred")
# Add a reference line to highlight the correlation
abline(lm(y ~ x), col = "blue", lwd = 2, lty = 2)
#4 basic
res <- residuals(model1)
plot(res[-length(res)], res[-1], pch = 16)
library(faraway)
dim(aatemp)
data1 <- aatemp[-c(1:8),]
head(data1)
dim(data1)
attach(data1)
model1 <- lm(temp ~ year, data=data1)
head(model1)
#5b
plot(data1$temp~year,type="o",pch=16,
xlab = "year", ylab = "temp")
#5c
model1 <- lm(temp ~year, data=data1)
#res <- residuals(model1)
#plot(res[-length(res)], res[-1])
#plot(model1$residuals[i+1]~model1$residual[i])
#cbind(model1$residuals[-1],model1$resi[-107])
plot(model1$residuals[-1],model1$resi[-107], type="o",pch=16)
#res <- residuals(model1)
#plot(res[-length(res)], res[-1])
#plot(model1$residuals[i+1]~model1$residual[i])
#cbind(model1$residuals[-1],model1$resi[-107])
#plot(model1$residuals[-1],model1$resi[-107], type="o",pch=16)
cor(model1$residual[-1], model$residual[-77])
#res <- residuals(model1)
#plot(res[-length(res)], res[-1])
#plot(model1$residuals[i+1]~model1$residual[i])
#cbind(model1$residuals[-1],model1$resi[-107])
#plot(model1$residuals[-1],model1$resi[-107], type="o",pch=16)
cor(model1$residual[-1], model1$residual[-77])
plot(model1$residual[-1], model1$residual[-77])
plot(model1$residual[-1], model1$residual[-77], pch=16, col="blue")
#res <- residuals(model1)
#plot(res[-length(res)], res[-1])
#plot(model1$residuals[i+1]~model1$residual[i])
#cbind(model1$residuals[-1],model1$resi[-107])
#plot(model1$residuals[-1],model1$resi[-107], type="o",pch=16)
dim(data1)
#res <- residuals(model1)
#plot(res[-length(res)], res[-1])
#plot(model1$residuals[i+1]~model1$residual[i])
#cbind(model1$residuals[-1],model1$resi[-107])
#plot(model1$residuals[-1],model1$resi[-107], type="o",pch=16)
dim(data1)
cor(model1$residual[-1], model1$residual[-107])
plot(model1$residual[-1], model1$residual[-107], pch=16, col="blue")
#res <- residuals(model1)
#plot(res[-length(res)], res[-1])
#plot(model1$residuals[i+1]~model1$residual[i])
#cbind(model1$residuals[-1],model1$resi[-107])
#plot(model1$residuals[-1],model1$resi[-107], type="o",pch=16)
dim(model1)
#res <- residuals(model1)
#plot(res[-length(res)], res[-1])
#plot(model1$residuals[i+1]~model1$residual[i])
#cbind(model1$residuals[-1],model1$resi[-107])
#plot(model1$residuals[-1],model1$resi[-107], type="o",pch=16)
dim(data1)
#res <- residuals(model1)
#plot(res[-length(res)], res[-1])
#plot(model1$residuals[i+1]~model1$residual[i])
#cbind(model1$residuals[-1],model1$resi[-107])
#plot(model1$residuals[-1],model1$resi[-107], type="o",pch=16)
dim(data1)
cor(model1$residual[-2], model1$residual[-107])
plot(model1$residual[-2], model1$residual[-107], pch=16, col="blue")
cor(model1$residual[-1], model1$residual[-107])
plot(model1$residual[-1], model1$residual[-107], pch=16, col="blue")
#5d
durbinWatsonTest(model1)
library(faraway)
data(divusa)
attach(divusa)
divusa[1:3,]
dim(divusa)
#1,2
model1 <- lm(divorce~unemployed+femlab+marriage+birth+military)
library(car)
durbinWatsonTest(model1)
load("C:/Users/Jonat/Downloads/calfire_plots (1).zip")
library(tidyverse)
library(readr)
library(lubridate)
setwd("../six_rivers/")
# load shapefile
ca_fires_shp <- st_read("California_Historic_Fire_Perimeters_-247493000743518952")
library(tidyverse)
library(readr)
library(lubridate)
setwd("../six_rivers/")
# load shapefile
ca_fires_shp <- st_read("California_Historic_Fire_Perimeters_-247493000743518952")
install.packages("C:/Users/Jonat/Downloads/calfire_plots (1).zip", repos = NULL, type = "win.binary")
library(tidyverse)
library(readr)
library(lubridate)
setwd("../six_rivers/")
library(tidyverse)
library(readr)
library(lubridate)
library(sf)
setwd("C:/Users/Jonat/OneDrive/Documents/Improving Torres/Cal_Fire/")
# load shapefile
ca_fires_shp <- st_read("California_Historic_Fire_Perimeters_-247493000743518952")
# filter to Six Rivers NF
srf = ca_fires_shp %>% dplyr::filter(UNIT_ID=="SRF")
# plot for fires occurring after 2010
srf %>% dplyr::filter(YEAR_>2010) %>%
ggplot(aes(fill=as.factor(CAUSE))) +
geom_sf()
unique(srf$CAUSE)
# match cause numbers to text
causes <- read.csv("fires data - Cause codes.csv") %>%
rename(CAUSE=code, cause_text=X)
srf_c <- left_join(srf, causes, by='CAUSE')
# plot for fires occurring after 2010
srf_c %>% dplyr::filter(YEAR_>2010) %>%
ggplot(aes(fill=cause_text)) +
geom_sf() +
scale_fill_brewer(palette='Set2') # changed color beccause rainbow is hard to read
##########################
srf_c %>%
dplyr::filter(YEAR_ > 2010) %>%
ggplot(aes(fill = cause_text)) +
geom_sf() +
scale_fill_brewer(palette = 'Set2') +
#coord_sf(xlim = c(min_longitude, max_longitude)) +  # Replace with actual longitude bounds
labs(title = "Wildfire Causes After 2010",
fill = "Causes")
#################################
srf_c %>%
dplyr::filter(YEAR_ > 2010) %>%
ggplot(aes(fill = cause_text)) +
geom_sf() +
scale_fill_manual(values = c(
"darkgreen", "blue", "orange", "purple", "red",
"brown", "gray", "black", "gold", "navy", "magenta"
)) +
labs(
title = "Wildfire Causes After 2010",
fill = "Causes"
)
# other option - interactive
# package leaflet
library(mapview)
# plot
six_rivers = srf_c %>% dplyr::filter(YEAR_>2010)
mapview(six_rivers,
zcol = "cause_text")
# options to plot over a static basemap
install.packages("ggmap")
#######################################################
# other option - static - ggspatial package
library(ggspatial)
# plot like regular ggplot
ggplot() +
annotation_map_tile(type = "osm", zoom=10) +
geom_sf(data=sr_shp, fill="grey") +
geom_sf(data = six_rivers, aes(fill = cause_text), color = "white", alpha = 0.9) +
coord_sf() +
#scale_fill_brewer(palette="Set2")
theme_minimal() +
# spatial-aware automagic scale bar
annotation_scale(location = "tl") +
# spatial-aware automagic north arrow
annotation_north_arrow(location = "br", which_north = "true")
# Step 1: Load the raster file
r <- raster("C:/Users/Jonat/Downloads/SixRivers_ForestLoss_FireOverlap_2014_2024 (2).tif")  # Replace with actual file path
# Load required library
library(raster)
# Step 1: Load the raster file
r <- raster("C:/Users/Jonat/Downloads/SixRivers_ForestLoss_FireOverlap_2014_2024 (2).tif")  # Replace with actual file path
# Step 2: Visualize the raster (optional)
plot(r, main = "Original Raster")
# Step 3: Set 0 values to NA for cleaner visualization
r[r == 0] <- NA
# Step 4: Check the CRS (Coordinate Reference System)
crs_string <- projection(r)
print(crs_string)  # This will show the CRS string, e.g., "+proj=utm +zone=10 +datum=WGS84"
# Step 5: Export the raster with CRS explicitly set
writeRaster(r, "path/to/exported_raster.tif", format = "GTiff", crs = crs_string, overwrite = TRUE)
# Step 5: Export the raster with CRS explicitly set
writeRaster(r, "C:\Users\Jonat\OneDrive\Documents\Improving Torres\Cal_Fire\Images", format = "GTiff", crs = crs_string, overwrite = TRUE)
# Step 5: Export the raster with CRS explicitly set
writeRaster(r, "C:/Users/Jonat/OneDrive/Documents/Improving Torres/Cal_Fire/Images", format = "GTiff", crs = crs_string, overwrite = TRUE)
# Step 1: Load the raster file
r <- raster("C:/Users/Jonat/Downloads/SixRivers_ForestLoss_FireOverlap_2014_2024 (3).tif")  # Replace with actual file path
# Step 2: Visualize the raster (optional)
plot(r, main = "Original Raster")
# Step 3: Set 0 values to NA for cleaner visualization
r[r == 0] <- NA
# Step 4: Check the CRS (Coordinate Reference System)
crs_string <- projection(r)
print(crs_string)  # This will show the CRS string, e.g., "+proj=utm +zone=10 +datum=WGS84"
# Step 5: Export the raster with CRS explicitly set
writeRaster(r, "C:/Users/Jonat/OneDrive/Documents/Improving Torres/Cal_Fire/Images", format = "GTiff", crs = crs_string, overwrite = TRUE)
# Step 4: Check the CRS (Coordinate Reference System)
crs_string <- projection(r)
print(crs_string)  # This will show the CRS string, e.g., "+proj=utm +zone=10 +datum=WGS84"
# Step 5: Export the raster with CRS explicitly set
writeRaster(r, "C:/Users/Jonat/OneDrive/Documents/Improving Torres/Cal_Fire/Images", format = "GTiff", crs = crs_string, overwrite = TRUE)
# Step 1: Load the raster file
r <- raster("C:/Users/Jonat/Downloads/SixRivers_ForestLoss_FireOverlap_2014_2024 (3).tif")  # Replace with actual file path
# Step 2: Visualize the raster (optional)
plot(r, main = "Original Raster")
# Step 3: Set 0 values to NA for cleaner visualization
r[r == 0] <- NA
# Step 4: Check the CRS (Coordinate Reference System)
crs_string <- projection(r)
print(crs_string)  # This will show the CRS string, e.g., "+proj=utm +zone=10 +datum=WGS84"
# Step 5: Export the raster with CRS explicitly set
writeRaster(r, "C:/Users/Jonat/OneDrive/Documents/Improving Torres/Cal_Fire/Images", format = "GTiff", crs = crs_string, overwrite = TRUE)
# Assuming you've already set 0s to NA
r[r == 0] <- NA
# Now visualize it
plot(r, main = "Raster with 0s set to NA", col = terrain.colors(100), na.col = "transparent")
